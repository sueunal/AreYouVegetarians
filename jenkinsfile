pipeline {
    agent any

    environment {
        PROJECT_NAME = "AreYouVegetarians"
        SCHEME = "AreYouVegetarians"
        CONFIGURATION = "Debug"
        SDK = "iphonesimulator"
        DESTINATION = "platform=iOS Simulator,name=iPhone 14"
    }

    stages {
        stage('ğŸ“¥ Checkout') {
            steps {
                echo "Git ì €ì¥ì†Œì—ì„œ í”„ë¡œì íŠ¸ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°"
                checkout scm
            }
        }

        stage('ğŸ› ï¸ Build') {
            steps {
                echo "Xcode í”„ë¡œì íŠ¸ ë¹Œë“œ ì‹œì‘"
                sh """
                xcodebuild clean \
                  -project ${PROJECT_NAME}.xcodeproj \
                  -scheme ${SCHEME} \
                  -configuration ${CONFIGURATION}

                xcodebuild build \
                  -project ${PROJECT_NAME}.xcodeproj \
                  -scheme ${SCHEME} \
                  -configuration ${CONFIGURATION} \
                  -destination '${DESTINATION}'
                """
            }
        }

        stage('ğŸ§ª Test') {
            steps {
                echo "Xcode í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘"
                sh """
                xcodebuild test \
                  -project ${PROJECT_NAME}.xcodeproj \
                  -scheme ${SCHEME} \
                  -configuration ${CONFIGURATION} \
                  -destination '${DESTINATION}' \
                  -allowProvisioningUpdates
                """
            }
        }

        stage('âœ… Done') {
            steps {
                echo "âœ… ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ!"
            }
        }
    }
}

